<!DOCTYPE html>
<script src='https://d3js.org/d3.v5.min.js'></script>
//<script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
//<select id="selectButton"></select>
<body onload="init();">
<svg width=800 height=600></svg>
<script>
async function init(){
//Get the data for GNI per capita
	const data = await d3.csv(
				 'https://varunhari2020.github.io/GNI_Per_Capita.csv');
	var margin = {top: 50, right: 50, bottom: 50, left: 50},
		width = 800 - margin.left - margin.right ,
		height = 600 - margin.top - margin.bottom;
// group the data: draw one line per group		
		 var sumstat = d3.nest() // nest function allows to group the calculation per level of a factor
		.key(function(d) { return d.Country Code;})
		.entries(data);
// Set the ranges
	var x = d3.scaleLinear()
			  .domain(d3.extent(data,function(d){return d.year;}))
			  .range([0, width]);
	var y = d3.scaleLog()
			  .base(10)	
			  .domain([0,d3.max(data,function(d){return +d.Value}))
			  .range([height, 0]);
// color palette
  var res = sumstat.map(function(d){ return d.Country Code });// list of country names
  var color = d3.scaleOrdinal()
    .domain(res)
    .range(d3.schemesSet2);			  

	var svg = d3.select("svg")
		.append("g")
		.attr("transform", "translate(50,50)");
//Append the Data	 
  svg.selectAll(".line")
      .data(sumstat)
      .enter()
      .append("path")
        .attr("fill", "none")
        .attr("stroke", function(d){ return color(d.key) })
        .attr("stroke-width", 1.5)
        .attr("d", function(d){
          return d3.line()
            .x(function(d) { return x(d.Year); })
            .y(function(d) { return y(+d.Value); })
            (d.values);
        })
		// Define the axes

// Y Axis
		d3.select("svg")
		.append("g")
		.attr("transform", "translate(50,50)")
		.call(d3.axisLeft(y).ticks(5).tickFormat(d3.format("~s")));
// X Axis
		d3.select("svg")
		.append("g")
		.attr("transform", "translate(50,600)")
		.call(d3.axisBottom(x).ticks(5).tickFormat(d3.format("~s")));
}
</script>
</body>
</html>